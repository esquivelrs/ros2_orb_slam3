<launch>
    <arg name="sensor_type"
        default="monocular"/>
    <arg name="use_pangolin"
        default="true"/>
    <arg name="use_live_feed"
        default="true"/>
    <arg name="map_file_name"
        default="default"/>
    <arg name="bag_name"
        default="nothing"/>
    <arg name="apriltag_family"
        default="tagStandard41h12"/>
    <arg name="tagsize"
        default="0.115"/>
    <arg name="record_bag"
        default="false"/>
    <arg name="time_now"
        default="temp"
        description="time_now:=$(date +%Y-%m-%d-%H-%M-%S)"/>
    <!-- https://answers.ros.org/question/325812/rosbag-and-parameters-dump-with-unique-timestamp-in-filename/ -->
    <!-- <include file="$(find-pkg-share realsense2_camera)/launch/rs_launch.py" if="$(eval '\'$(var use_live_feed)\' == \'true\'')">
        <arg name="enable_accel" value="true"/>
        <arg name="enable_gyro" value="true"/>
        <arg name="unite_imu_method" value="2"/>
        <arg name="enable_depth" value="false"/>
    </include> -->
    <node pkg="ros2_orb_slam3"
        exec="apriltag_node">
        <param name="apriltag_family"
            value="$(var apriltag_family)"/>
        <param name="tagsize"
            value="$(var tagsize)"/>
    </node>
    <node pkg="ros2_orb_slam3"
        exec="imu_mono_node_cpp"
        output="screen">
        <param name="use_sim_time"
            value="true"/>
        <param name="sensor_type"
            value="$(var sensor_type)"/>
        <param name="use_pangolin"
            value="true"/>
        <param name="use_live_feed"
            value="$(var use_live_feed)"/>
        <param name="file_name"
            value="$(var map_file_name)"/>
        <remap from="camera/color/image_raw"
            to="/tractor/camera/front_center/image_raw"/>
        <remap from="camera/imu"
            to="/tractor/novatel/imu/data"/>
    </node>
    <executable cmd="ros2 bag play /home/ros/ws/rosbags/thesis/agrirobot_agrirobot_reproducible_setup_bosch_bottom_2024-09-20-10-45-34.mcap --clock --start-offset 0"/>
    <executable cmd="ros2 bag play $(find-pkg-share ros2_orb_slam3)/bags/$(var bag_name) --clock"
        if="$(eval '\'$(var bag_name)\' != \'nothing\' and \'$(var record_bag)\' == \'false\'')"/>
    <executable cmd="ros2 bag record -a -o ./ros2_orb_slam3/bags/$(var time_now)_$(var bag_name).bag"
        if="$(eval '\'$(var record_bag)\' == \'true\'')"/>
</launch>
